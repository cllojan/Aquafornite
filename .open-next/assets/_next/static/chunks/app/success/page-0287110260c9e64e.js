(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[582],{2239:(e,t,r)=>{"use strict";r.d(t,{J:()=>d,UserProvider:()=>l});var s=r(5155),i=r(1026),n=r(2115);let o=e=>fetch(e).then(e=>e.json()),a=(0,n.createContext)(null);function l(e){let{children:t}=e,{data:r,error:n,isLoading:l}=(0,i.Ay)("/api/profile",o);return(0,s.jsx)(a.Provider,{value:{user:r||null,isLoading:l},children:t})}function d(){let e=(0,n.useContext)(a);if(!e)throw Error("Error: useUser debe ser usado dentro de UserProvider");return e}},5255:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(5155),i=r(6279),n=r(2239),o=r(5239),a=r(2619),l=r.n(a),d=r(2115);function c(){let{items:e,removeAll:t}=(0,i.N)(),{user:r,isLoading:a}=(0,n.J)(),[c,u]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{a&&0!==e.length&&!c&&(async()=>{if(!r){console.log("⚠️ Usuario no registrado, no se guardar\xe1 historial."),t();return}try{let t=e.map(e=>e.discount),s={user_id:null==r?void 0:r.id,items:e.map(e=>{var t,r,s,i;return{name:(null==e||null==(t=e.bundle)?void 0:t.name)||(null==e||null==(r=e.brItems)?void 0:r[0].name)||(null==(s=e.tracks)?void 0:s[0].title),price:e.discount,image:(null==e||null==(i=e.newDisplayAsset)?void 0:i.renderImages[0].image)||e.tracks[0].albumArt}}),total:t.reduce((e,t)=>e+t,0)};console.log(s);let i=await fetch("/api/history",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(s)}),n=await i.json();console.log("Historial guardado",n)}catch(e){console.log("Error al guardar",e)}finally{t(),u(!0)}})()},[a,e,r,c]),(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full text-center",children:[(0,s.jsx)("div",{className:"mb-4 flex justify-center",children:(0,s.jsx)(o.default,{src:"/images/check_circle.png",alt:"check",width:100,height:100})}),(0,s.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Gracias!"}),(0,s.jsx)("p",{className:"text-gray-00 mb-8",children:"Tu compra fue exitosa "}),(0,s.jsx)(l(),{href:"/",children:(0,s.jsx)("button",{className:"btn btn-primary",children:"Volver a la inicio"})})]})})}},6279:(e,t,r)=>{"use strict";r.d(t,{N:()=>n});var s=r(5959),i=r(854);let n=(0,s.v)((e,t)=>({items:[],addItem:r=>{let s=t().items;if(console.log(s),s.find(e=>e.devName===r.devName))return i.P.error("\xa1Producto ya esta agregado al carrito !",{duration:3e3,position:"top-right",transition:"swingInverted",icon:"",sound:!0});e({items:[...t().items,r]}),i.P.success("\xa1Producto registrado con \xe9xito, gracias \uD83D\uDE18!",{duration:2500,position:"top-right",transition:"swingInverted",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-thumbs-up"><path d="M7 10v12"/><path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z"/></svg>',sound:!0})},removeItem:r=>{e({items:[...t().items.filter(e=>e.devName!=r)]})},removeAll:()=>e({items:[]})}))},8096:(e,t,r)=>{Promise.resolve().then(r.bind(r,5255))}},e=>{e.O(0,[783,26,239,878,441,255,358],()=>e(e.s=8096)),_N_E=e.O()}]);